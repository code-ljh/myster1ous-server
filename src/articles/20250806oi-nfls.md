# CSP 模拟赛 2025-08-06

## T1 snum

给定区间 $L,R$，问 $L,R$ 之间有几个满足 $S(x^2)=S(x)^2$ 的数。

### 打表

我第一眼就看出这个可以打表（哈哈给的最大范围输入样例显然是让你打表）。

然后随便就 AC 了。

### 赛时做法

推式子证明出来显然 $x$ 十进制每一位都必须小于等于 $3$。

于是满足每一位小于等于 $3$ 的数已经很少了，枚举即可。

### STD 做法

不难发现 $S(x^2) \leqslant S(10^{18}-1) \leqslant 9\times18$。

$S(x)=\sqrt{S(x^2)}\leqslant \sqrt{9\times18}= 9\sqrt{2}\approx 13$。

这已经是一个比较强的性质了，枚举（搜索）即可。

## T2 maze

给定字符矩阵 $2000\times2000$；

只能往右、往下走，问从左上到右下路径经过的字符按顺序排列最小的字典序。

不难发现出现在最终的路径的第 $i$ 位一共最多就是那些个字符，我们考虑 $\text{bfs}$，“深度”就是格子在路径中出现的位置。显然如果一个格子不能在当前深度中达到可以实现的最优解那么就没必要扩展了。最后扩展到终点按照 $\text{pre}$ 递归输出即可。

简单题。

## T3 region

洛谷原题，IOI 2009 的题目。

比较神奇，$n=2\times10^5$ 但是是根号，逆天。

写了一个 $\mathcal{O}(n\sqrt{n}\log{n})$ 的大常数做法，抽象完了。

题意：给定一棵树，每个节点有颜色，$q$ 个询问，每次询问给两种颜色 $r_1,r_2$，问有多少个 $(i,j)$ 的树上点对同时满足以下条件：

- $\text{color}(i)=r_1$
- $\text{color}(j)=r_2$
- $i \text{ is }j\text{'s ancestor}$

不难发现其实就是对于每一个 $r_1$ 的节点求出其子树内有几个 $r_2$ 的节点 $j$，这样我们就有了一个 $\mathcal{O}(n|r_1|\log n)$ 的做法。

考虑如果预处理每一个 $r_1$ 又会超时，于是我们直接根号分治，对于不超过 $\sqrt{n}$ 的小颜色枚举元素 $\log n$ 算询问，对于大于 $\sqrt{n}$ 的大颜色暴力预处理。（赛时做法）

最终复杂度 $\mathcal{O}(n\sqrt{n}\log{n})$。

写出 $\mathcal{O}(n\sqrt{n})$ 来补档。